# sqlxb v1.0.0 路线图

## 🎯 发布目标

**目标日期**: 2025年 Q4 (提前至 11-12 月)

**定位**: 生产级、AI-First、向量数据库 ORM

**核心价值**:
- ✅ 编译时类型安全
- ✅ 9 层自动过滤机制
- ✅ PostgreSQL + Qdrant 双后端支持
- ✅ AI 友好的 API 设计
- ✅ 100% 向后兼容

**战略**:
- v1.0.0 = 生产就绪，吸引更多维护者
- v1.x = 持续演进，社区驱动
- v2.0.0 = 未来的重大升级（如需 Breaking Changes）

---

## 📅 版本规划

### v0.9.x 系列（2025 Q1-Q2）

#### v0.9.1 ✅ (已完成)
- [x] 修复 float64/int 零值过滤
- [x] 修复向量查询中的 OR/AND 子查询
- [x] 新增 6 个回归测试
- [x] 创建测试策略文档

#### v0.9.2 ✅ (已完成)
- [x] 新增 Interceptor 拦截器（基础设施观察）
- [x] 新增扩展指南文档（自定义向量数据库、自定义 JOIN）
- [x] 清理过时文档（7 个早期设计文档）
- [x] 更新所有 API 示例

#### v0.10.0 ✅ (已完成)
- [x] Qdrant Recommend API（基于正负样本的推荐）
- [x] Qdrant Discover API（基于上下文的探索查询）
- [x] Qdrant Scroll API（大数据集游标遍历）
- [x] 函数式参数风格统一
- [x] 7 个新测试全部通过
- [x] 完整文档（QDRANT_ADVANCED_API.md）

#### v0.10.1 ✅ (已完成)
- [x] Limit() API（简单查询分页）
- [x] Offset() API（跳过记录数）
- [x] Paged() 优先级保护（Web 分页优先于 Limit/Offset）
- [x] ai_application/ 文档全面修复（70+ 处）
  - [x] API 用法修正（ToQdrantSearch、VectorSearch、QdrantX）
  - [x] 移除不必要的 nil/0/empty 判断（利用自动过滤）
  - [x] 修正 Like() 用法（自动添加 % 通配符）
  - [x] 修正 GitHub 用户名（x-ream）
  - [x] 修正 DocID 类型（指针，支持 nil）
- [x] 7 个新测试全部通过
- [x] 100% 向后兼容

#### v0.10.2 ✅ (已完成)
- [x] SQL 生成优化
  - strings.Builder 预分配容量
  - 6 个核心函数优化
  - 减少内存重新分配 50-80%
- [x] 73 个测试全部通过
- [x] 100% 向后兼容

#### v0.10.3 ✅ (已完成)
- [x] 最佳实践文档
  - Builder 使用最佳实践（BUILDER_BEST_PRACTICES.md）
  - 常见错误和解决方法（COMMON_ERRORS.md）
- [x] 完整应用示例（3个）
  - PostgreSQL + pgvector 完整应用（代码搜索）
  - Qdrant 集成完整应用（文档检索）
  - RAG 检索应用示例（LLM 集成）
- [x] 100% 向后兼容

#### v0.10.4 ✅ (已完成)
- [x] PageIndex 集成
  - PageIndex 集成指南文档（PAGEINDEX_INTEGRATION.md）
  - 使用场景决策指南（USE_CASE_GUIDE_ZH.md）
  - 完整应用示例（pageindex-app）
  - 层级结构查询最佳实践
- [x] 100% 向后兼容

#### v0.10.5 (计划: 2025年9月)
**重点：API 稳定性与迁移指南**

- [ ] **API 审查**
  - 确保命名一致性
  - 检查是否有废弃 API
  - 标记 experimental API
  
- [ ] **迁移指南**
  - 从 GORM 迁移到 sqlxb
  - 从 XORM 迁移到 sqlxb
  - sqlxb 版本升级指南
  
- [ ] **API 完整性检查**
  - 所有 API 都有文档
  - 所有 API 都有示例
  - 所有 API 都有测试

---

## 🎉 v1.0.0 (目标: 2025年11月)

### 最小发布标准（实用主义）

#### 核心功能 ✅
- [x] 基础 ORM 功能完整
- [x] 向量数据库支持
- [x] AI-First API 设计
- [x] 测试覆盖率 ≥ 85%
- [x] 100% 向后兼容

#### 文档要求 ✅
- [x] 核心 API 文档完整
- [x] 12+ AI 应用文档
- [x] 快速开始指南
- [x] 最佳实践示例
- [ ] 迁移指南（v1.0.3 补充）

#### 质量保证 ✅
- [x] 73 个测试全部通过
- [x] 零已知严重 bug
- [x] 性能优化完成
- [x] 代码可读性良好

---

## 🚀 v1.0.0 之后的演进

### v1.0.x 系列（稳定维护）
- v1.0.1-1.0.3: Bug 修复和文档完善

### v1.1.0 (2025年12月)
**重点：开发者体验**
- 错误提示改进
- 完整应用示例
- Builder 使用最佳实践文档

### v1.2.0 (2026年2月)
**重点：API 稳定化**
- API 审查和优化
- 迁移指南完善
- 性能基准测试

### v1.3.0 (2026年4月)
**重点：代码质量**
- 测试覆盖率提升至 95%+
- 静态分析零警告
- Fuzz 测试

### v1.4.0+ (2026年中)
**重点：社区驱动**
- 根据社区反馈持续改进
- 新功能由维护者团队决定
- 保持 100% 向后兼容

### v2.0.0 (未来)
**仅在必须 Breaking Changes 时发布**

---

## 🎯 v1.0.0 核心特性清单

### 基础 ORM 功能 ✅

- [x] 类型安全的查询构建
- [x] 自动 nil/0 过滤
- [x] And/Or 子查询
- [x] Join 支持
- [x] GroupBy/Having
- [x] Pagination
- [x] 聚合函数
- [x] 子查询

### 向量数据库支持 ✅

- [x] PostgreSQL pgvector
- [x] Qdrant 集成
- [x] 向量相似度搜索
- [x] 混合查询（标量 + 向量）
- [x] 距离度量（Cosine, L2, Inner Product）
- [x] 结果多样性（Hash, Distance, MMR）
- [x] Qdrant 高级 API（Recommend, Discover, Scroll）v0.10.0 ✅
- [x] Limit/Offset API（简单分页）v0.10.1 ✅

### AI-First 设计 ✅

- [x] 函数式 API（AI 友好）
- [x] 编译时类型检查
- [x] 自动过滤机制（9 层）
- [x] 优雅降级（多后端兼容）
- [x] AI 应用生态文档（v0.10.1）✅
  - [x] JSON Schema 生成指南（AGENT_TOOLKIT.md）
  - [x] NL2SQL 实现示例（NL2SQL.md，实验性）
  - [x] RAG 最佳实践（RAG_BEST_PRACTICES.md）
  - [x] LangChain/LlamaIndex/SK 集成

### 性能优化

- [x] SQL 生成优化（v0.10.2）✅
  - [x] strings.Builder 预分配容量
  - [x] 6 个核心函数优化
  - [x] 减少内存重新分配 50-80%

### 测试与质量

- [x] 单元测试覆盖 ≥ 85%
- [ ] 单元测试覆盖 ≥ 95%（v0.11.0）
- [x] 回归测试套件
- [ ] 集成测试（v0.9.3）
- [ ] 性能基准测试（v0.9.2）
- [ ] Fuzz 测试（v0.11.0）

---

## 📊 当前进度（v0.10.2）

### 已完成功能

```
功能完整度: ████████████░░ 90%  (已足够 v1.0.0)
测试覆盖度: ████████████░░ 85%  (已足够 v1.0.0)
文档完整度: ███████████░░░ 75%  (持续补充中)
生产就绪度: ███████████░░░ 85%  (✅ 可发布 v1.0.0)
```

### 距离 v1.0.0

```
只差 v0.10.5！

v0.10.5 (9月): API 稳定性 + 迁移指南
v1.0.0 (11月): 🎉 正式发布
```

**战略**:
- 不追求完美，追求实用
- v1.0.0 = 生产就绪
- v1.x 持续演进

---

## 🚀 关键里程碑（提前发布战略）

| 时间节点 | 版本 | 里程碑 | 进度 |
|---------|------|--------|------|
| 2025-01 | v0.10.1 | Limit/Offset + 文档修复 | ✅ 已完成 |
| 2025-02 | v0.10.2 | SQL 生成性能优化 | ✅ 已完成 |
| 2025-02 | v0.10.3 | 最佳实践 + 完整示例 | ✅ 已完成 |
| 2025-02 | v0.10.4 | PageIndex 集成 + 场景指南 | ✅ 已完成 |
| 2025-09 | v0.10.5 | API 稳定性 + 迁移指南 | 🟡 计划中 |
| **2025-11** | **v1.0.0** | **🎉 正式发布** | 🟡 即将开始 |
| 2025-12 | v1.1.0 | 开发者体验增强 | 待开始 |
| 2026-02 | v1.2.0 | API 稳定化 | 待开始 |
| 2026-04 | v1.3.0 | 代码质量提升 | 待开始 |
| 2026-06+ | v1.4.0+ | 社区驱动演进 | 待开始 |

---

## 💭 为什么提前发布 v1.0.0？

### 战略优势

```
1. 心理效应 🎯
   v0.x = "实验性，不稳定"
   v1.0.0 = "生产就绪，值得信赖"
   
2. 社区吸引力 👥
   ✅ 更容易获得用户信任
   ✅ 更容易吸引贡献者加入
   ✅ 更容易获得企业采用
   ✅ 更容易获得 GitHub Stars
   
3. 持续演进 🚀
   v1.0.0 不是终点，是起点
   v1.1, v1.2 持续改进
   保持 100% 向后兼容
```

### 当前状态已足够

```
功能：90% ✅
  - 基础 ORM 完整
  - 向量数据库支持完整
  - AI 生态文档完整

测试：85% ✅
  - 73 个测试全部通过
  - 覆盖核心功能
  - 足以投入生产

质量：高 ✅
  - 零已知严重 bug
  - 性能优化完成
  - 代码可读性良好
```

### v1.0.0 的真正含义

```
❌ 不是"完美无缺"
✅ 是"生产就绪"

v1.0.0 承诺：
  ✅ API 稳定（向后兼容）
  ✅ 核心功能完整
  ✅ 可安全用于生产
  ✅ 持续维护和改进
```

---

## 💡 设计原则（v1.0.0 不变）

### 1. AI-First，Human-Readable

```go
// ✅ AI 能轻松理解和生成
sqlxb.Of(&User{}).
    Eq("status", "active").
    Or(func(cb *CondBuilder) {
        cb.Gte("age", 18).OR().Eq("verified", true)
    }).
    Build()

// ❌ AI 容易出错
db.Model(&User{}).
    Where("status = ?", "active").
    Where("age >= ? OR verified = ?", 18, true)
```

### 2. 编译时安全，运行时灵活

- 编译时类型检查
- 运行时自动过滤
- 优雅降级

### 3. 零配置，最佳实践

- 默认行为是最佳实践
- 无需配置文件
- 约定优于配置

### 4. 向后兼容，渐进增强

- v1.0.0 100% 兼容 v0.9.0+
- 废弃功能保留至少 2 个大版本
- 清晰的迁移指南

