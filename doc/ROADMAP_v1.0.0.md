# sqlxb v1.0.0 路线图

## 🎯 发布目标

**目标日期**: 2026年 Q2-Q3

**定位**: 生产级、AI-First、向量数据库 ORM

**核心价值**:
- ✅ 编译时类型安全
- ✅ 9 层自动过滤机制
- ✅ PostgreSQL + Qdrant 双后端支持
- ✅ AI 友好的 API 设计
- ✅ 100% 向后兼容

---

## 📅 版本规划

### v0.9.x 系列（2025 Q1-Q2）

#### v0.9.1 ✅ (已完成)
- [x] 修复 float64/int 零值过滤
- [x] 修复向量查询中的 OR/AND 子查询
- [x] 新增 6 个回归测试
- [x] 创建测试策略文档

#### v0.9.2 ✅ (已完成)
- [x] 新增 Interceptor 拦截器（基础设施观察）
- [x] 新增扩展指南文档（自定义向量数据库、自定义 JOIN）
- [x] 清理过时文档（7 个早期设计文档）
- [x] 更新所有 API 示例

#### v0.10.0 ✅ (已完成)
- [x] Qdrant Recommend API（基于正负样本的推荐）
- [x] Qdrant Discover API（基于上下文的探索查询）
- [x] Qdrant Scroll API（大数据集游标遍历）
- [x] 函数式参数风格统一
- [x] 7 个新测试全部通过
- [x] 完整文档（QDRANT_ADVANCED_API.md）

#### v0.10.1 ✅ (已完成)
- [x] Limit() API（简单查询分页）
- [x] Offset() API（跳过记录数）
- [x] Paged() 优先级保护（Web 分页优先于 Limit/Offset）
- [x] ai_application/ 文档全面修复（70+ 处）
  - [x] API 用法修正（ToQdrantSearch、VectorSearch、QdrantX）
  - [x] 移除不必要的 nil/0/empty 判断（利用自动过滤）
  - [x] 修正 Like() 用法（自动添加 % 通配符）
  - [x] 修正 GitHub 用户名（x-ream）
  - [x] 修正 DocID 类型（指针，支持 nil）
- [x] 7 个新测试全部通过
- [x] 100% 向后兼容

#### v0.10.2 ✅ (已完成)
- [x] SQL 生成优化
  - strings.Builder 预分配容量
  - 6 个核心函数优化
  - 减少内存重新分配 50-80%
- [x] 73 个测试全部通过
- [x] 100% 向后兼容

#### v0.10.3 (计划: 2025年7月)
**重点：生产环境验证**

- [ ] 真实数据库集成测试
  - PostgreSQL + pgvector 集成
  - Qdrant 集成测试
  - 连接池测试
- [ ] 并发安全性
  - Builder 并发使用测试
  - 多 goroutine 压力测试
- [ ] 错误处理改进
  - 更友好的错误消息
  - 错误码标准化
  - 链式错误追踪
- [ ] 生产案例
  - 至少 3 个真实项目案例
  - 性能数据收集
  - 问题反馈收集

#### v0.10.4 (计划: 2025年9月)
**重点：API 稳定性**

- [ ] API 审查
  - 确保命名一致性
  - 移除废弃 API
  - 标记 experimental API
- [ ] 文档完善
  - API 文档完整性
  - 迁移指南（从其他 ORM）
  - 最佳实践指南
- [ ] Breaking Changes 清单
  - 列出所有不兼容变更
  - 提供迁移脚本
  - 版本升级指南

---

### v0.10.x 系列（2025 Q3-Q4）

#### v0.10.2 (计划: 2025年9月)
**重点：向量数据库生态完善**

- [ ] LanceDB 支持（可选）
  - 评估 LanceDB 集成价值
  - 如果有需求，添加支持
- [ ] Qdrant 高级配置
  - Collection 管理 API
  - Payload 索引优化
  - Quantization 配置支持
- [ ] 向量数据迁移工具
  - PostgreSQL → Qdrant 迁移脚本
  - 批量导入工具
  - 数据格式转换

#### v0.10.3 (计划: 2025年11月)
**重点：开发者体验优化**

- [ ] 查询日志增强
  - SQL 格式化输出
  - 执行时间统计
  - 慢查询警告
- [ ] 错误提示改进
  - 更友好的错误消息
  - 常见错误的解决建议
  - 调试模式支持
- [ ] IDE 支持增强
  - GoLand 插件（可选）
  - VSCode 代码片段
  - 文档内嵌提示

---

### v0.11.x 系列（2026 Q1）

#### v0.11.0 (计划: 2026年1月)
**重点：代码质量与稳定性**

- [ ] 代码覆盖率 ≥ 95%
  - 所有核心模块 95%+
  - 边界条件完整覆盖
  - Fuzz 测试
- [ ] 静态分析
  - golangci-lint 零警告
  - go vet 零问题
  - gosec 安全检查
- [ ] 依赖管理
  - 最小化外部依赖
  - 依赖安全审计
  - License 合规检查

#### v0.11.1 (计划: 2026年3月)
**重点：文档与社区**

- [ ] 文档网站
  - 独立文档站点
  - 交互式示例
  - 搜索功能
- [ ] 多语言文档
  - 中文文档完善
  - 英文文档完善
  - 示例代码双语
- [ ] 社区建设
  - GitHub Discussions
  - Issue 模板完善
  - 贡献者指南

---

### v0.12.0-rc (2026 Q2)

#### v0.12.0-rc.1 (计划: 2026年4月)
**第一个 Release Candidate**

- [ ] 功能冻结
  - 不再添加新功能
  - 只修复 bug
- [ ] 公开测试
  - Beta 测试计划
  - 社区反馈收集
  - Bug 悬赏计划

#### v0.12.0-rc.2 (计划: 2026年5月)
**第二个 Release Candidate**

- [ ] Bug 修复
  - 修复所有严重 bug
  - 修复所有高优先级 bug
- [ ] 性能验证
  - 大规模数据测试
  - 长时间稳定性测试

---

## 🎉 v1.0.0 (目标: 2026年6月)

### 发布标准

#### 必须满足的条件 ✅

1. **代码质量**
   - [ ] 测试覆盖率 ≥ 95%
   - [ ] 零已知严重 bug
   - [ ] 零已知性能问题
   - [ ] golangci-lint 零警告

2. **文档完整**
   - [ ] API 文档 100% 覆盖
   - [ ] 至少 20 个完整示例
   - [ ] 迁移指南（从 GORM/sqlx）
   - [ ] 性能优化指南
   - [ ] 故障排查指南

3. **生产验证**
   - [ ] 至少 5 个生产环境案例
   - [ ] 至少 1 个大规模应用（>100万用户）
   - [ ] 性能基准数据
   - [ ] 稳定性证明（>3 个月无重大问题）

4. **社区认可**
   - [ ] GitHub Stars ≥ 1000
   - [ ] 至少 10 个外部贡献者
   - [ ] 至少 50 个 Issues 已解决
   - [ ] 至少 20 个 Pull Requests 已合并

5. **兼容性**
   - [ ] Go 1.21+ 支持
   - [ ] PostgreSQL 12+ 支持
   - [ ] Qdrant 1.8+ 支持
   - [ ] 100% 向后兼容 v0.9.0+

---

## 🎯 v1.0.0 核心特性清单

### 基础 ORM 功能 ✅

- [x] 类型安全的查询构建
- [x] 自动 nil/0 过滤
- [x] And/Or 子查询
- [x] Join 支持
- [x] GroupBy/Having
- [x] Pagination
- [x] 聚合函数
- [x] 子查询

### 向量数据库支持 ✅

- [x] PostgreSQL pgvector
- [x] Qdrant 集成
- [x] 向量相似度搜索
- [x] 混合查询（标量 + 向量）
- [x] 距离度量（Cosine, L2, Inner Product）
- [x] 结果多样性（Hash, Distance, MMR）
- [x] Qdrant 高级 API（Recommend, Discover, Scroll）v0.10.0 ✅
- [x] Limit/Offset API（简单分页）v0.10.1 ✅

### AI-First 设计 ✅

- [x] 函数式 API（AI 友好）
- [x] 编译时类型检查
- [x] 自动过滤机制（9 层）
- [x] 优雅降级（多后端兼容）
- [x] AI 应用生态文档（v0.10.1）✅
  - [x] JSON Schema 生成指南（AGENT_TOOLKIT.md）
  - [x] NL2SQL 实现示例（NL2SQL.md，实验性）
  - [x] RAG 最佳实践（RAG_BEST_PRACTICES.md）
  - [x] LangChain/LlamaIndex/SK 集成

### 性能优化

- [x] SQL 生成优化（v0.10.2）✅
  - [x] strings.Builder 预分配容量
  - [x] 6 个核心函数优化
  - [x] 减少内存重新分配 50-80%

### 测试与质量

- [x] 单元测试覆盖 ≥ 85%
- [ ] 单元测试覆盖 ≥ 95%（v0.11.0）
- [x] 回归测试套件
- [ ] 集成测试（v0.9.3）
- [ ] 性能基准测试（v0.9.2）
- [ ] Fuzz 测试（v0.11.0）

---

## 📊 当前进度

### 已完成功能（v0.9.1）

```
功能完整度: ████████████░░ 85%
测试覆盖度: ████████████░░ 85%
文档完整度: █████████░░░░░ 70%
生产就绪度: ████████░░░░░░ 60%
```

### 距离 v1.0.0 还需要

1. **功能补充**: 15% (主要是向量数据库高级功能)
2. **测试完善**: 15% (达到 95% 覆盖率)
3. **文档完善**: 30% (文档网站、多语言、案例)
4. **生产验证**: 40% (需要更多真实案例)

---

## 🚀 关键里程碑

| 时间节点 | 版本 | 里程碑 | 进度 |
|---------|------|--------|------|
| 2025-03 | v0.10.1 | 性能优化完成 | 待开始 |
| 2025-05 | v0.10.2 | 生产环境验证 | 待开始 |
| 2025-07 | v0.10.3 | API 稳定化 | 待开始 |
| 2025-09 | v0.11.0 | 向量功能完善 | 待开始 |
| 2025-11 | v0.11.1 | AI 生态集成 | 待开始 |
| 2026-01 | v0.12.0 | 代码质量达标 | 待开始 |
| 2026-03 | v0.12.1 | 文档与社区 | 待开始 |
| 2026-04 | v0.12.0-rc.1 | 第一个 RC | 待开始 |
| 2026-05 | v0.12.0-rc.2 | 第二个 RC | 待开始 |
| **2026-06** | **v1.0.0** | **正式发布** | 待开始 |

---

## 💡 设计原则（v1.0.0 不变）

### 1. AI-First，Human-Readable

```go
// ✅ AI 能轻松理解和生成
sqlxb.Of(&User{}).
    Eq("status", "active").
    Or(func(cb *CondBuilder) {
        cb.Gte("age", 18).OR().Eq("verified", true)
    }).
    Build()

// ❌ AI 容易出错
db.Model(&User{}).
    Where("status = ?", "active").
    Where("age >= ? OR verified = ?", 18, true)
```

### 2. 编译时安全，运行时灵活

- 编译时类型检查
- 运行时自动过滤
- 优雅降级

### 3. 零配置，最佳实践

- 默认行为是最佳实践
- 无需配置文件
- 约定优于配置

### 4. 向后兼容，渐进增强

- v1.0.0 100% 兼容 v0.9.0+
- 废弃功能保留至少 2 个大版本
- 清晰的迁移指南

